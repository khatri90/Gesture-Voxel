<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gesture Voxel Editor</title>
  <link rel="stylesheet" href="/styles/main.css">
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="logo">
      <span class="logo-icon">&#9632;</span>
      <span class="logo-text">Gesture Voxel Editor</span>
    </div>
    <div class="header-actions">
      <button id="tutorialBtn" class="btn btn-icon" title="Tutorial">?</button>
      <button id="exportBtn" class="btn btn-icon" title="Export">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
          <polyline points="7 10 12 15 17 10"/>
          <line x1="12" y1="15" x2="12" y2="3"/>
        </svg>
      </button>
      <button id="screenshotBtn" class="btn btn-icon" title="Screenshot">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
          <circle cx="8.5" cy="8.5" r="1.5"/>
          <polyline points="21 15 16 10 5 21"/>
        </svg>
      </button>
    </div>
  </header>

  <!-- Main Container -->
  <main class="main-container">
    <!-- Webcam Panel -->
    <div class="webcam-panel">
      <video id="webcam" autoplay playsinline></video>
      <canvas id="handCanvas"></canvas>
      <div class="gesture-indicator">
        <span class="gesture-label">Gesture:</span>
        <span id="currentGesture" class="gesture-value">WAITING...</span>
      </div>
      <div class="mode-indicator">
        <span id="currentMode">PLACE MODE</span>
      </div>
    </div>

    <!-- 3D Canvas Panel -->
    <div class="canvas-panel">
      <canvas id="threeCanvas"></canvas>

      <!-- Color Palette -->
      <div class="color-palette" id="colorPalette">
        <div class="palette-label">Colors</div>
        <div class="palette-colors"></div>
      </div>

      <!-- Cursor Position -->
      <div class="cursor-info" id="cursorInfo">
        <span>Cursor: </span>
        <span id="cursorPos">--</span>
      </div>

      <!-- Voxel Count -->
      <div class="voxel-count">
        <span>Voxels: </span>
        <span id="voxelCount">0</span>
      </div>
    </div>
  </main>

  <!-- Tutorial Modal -->
  <div id="tutorialModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Gesture Controls</h2>
        <button class="modal-close" id="closeTutorial">&times;</button>
      </div>
      <div class="modal-body">
        <div class="gesture-guide">
          <div class="gesture-item">
            <div class="gesture-icon">&#9757;</div>
            <div class="gesture-info">
              <strong>Point</strong>
              <p>Move cursor to highlight voxel position</p>
            </div>
          </div>
          <div class="gesture-item">
            <div class="gesture-icon">&#129295;</div>
            <div class="gesture-info">
              <strong>Pinch</strong>
              <p>Place a voxel at cursor position</p>
            </div>
          </div>
          <div class="gesture-item">
            <div class="gesture-icon">&#9994;</div>
            <div class="gesture-info">
              <strong>Fist</strong>
              <p>Delete voxel at cursor position</p>
            </div>
          </div>
          <div class="gesture-item">
            <div class="gesture-icon">&#9995;</div>
            <div class="gesture-info">
              <strong>Open Palm</strong>
              <p>Move hand to rotate camera</p>
            </div>
          </div>
          <div class="gesture-item">
            <div class="gesture-icon">&#9996;</div>
            <div class="gesture-info">
              <strong>Peace Sign</strong>
              <p>Cycle through colors</p>
            </div>
          </div>
          <div class="gesture-item">
            <div class="gesture-icon">&#128072;</div>
            <div class="gesture-info">
              <strong>Swipe Left</strong>
              <p>Undo last action</p>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-primary" id="startBtn">Start Creating!</button>
      </div>
    </div>
  </div>

  <!-- Export Modal -->
  <div id="exportModal" class="modal">
    <div class="modal-content modal-small">
      <div class="modal-header">
        <h2>Export Creation</h2>
        <button class="modal-close" id="closeExport">&times;</button>
      </div>
      <div class="modal-body">
        <div class="export-options">
          <button class="btn btn-export" id="exportOBJ">
            <span class="export-format">OBJ</span>
            <span class="export-desc">Standard 3D format</span>
          </button>
          <button class="btn btn-export" id="exportGLB">
            <span class="export-format">GLB</span>
            <span class="export-desc">Web-optimized format</span>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Loading Overlay -->
  <div id="loadingOverlay" class="loading-overlay">
    <div class="loading-content">
      <div class="loading-spinner"></div>
      <p>Initializing camera...</p>
    </div>
  </div>

  <!-- MediaPipe Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js" crossorigin="anonymous"></script>

  <!-- Main App -->
  <script type="module" src="/src/main.js"></script>
</body>
</html>
