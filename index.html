<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gesture Voxel Editor</title>
  <link rel="stylesheet" href="/styles/main.css">
</head>

<body>
  <!-- Header -->
  <!-- Header / HUD -->
  <header class="header">
    <div class="logo">
      <span class="logo-text">BIO_SYNC: GESTURE_ARCHITECT_v2.0</span>
    </div>

    <div class="hud-stat">
      STATE: <span id="currentMode" class="hud-val">INITIALIZING</span>
    </div>

    <div class="hud-stat">
      GESTURE: <span id="currentGesture" class="hud-val">--</span>
    </div>

    <div class="hud-stat">
      VOXELS: <span id="voxelCount" class="hud-val">0</span>
    </div>

    <div class="hud-stat">
      CURSOR: <span id="cursorPos" class="hud-val">--</span>
    </div>

    <div class="header-actions">
      <button id="modeToggleBtn" class="btn">MODE [2D/3D]</button>
      <button id="exportBtn" class="btn">EXPORT</button>
      <button id="tutorialBtn" class="btn">HELP</button>
      <!-- Hidden screenshot button to keep JS happy if needed, or just remove if we don't care -->
      <button id="screenshotBtn" class="btn" style="display:none;">SHOT</button>
    </div>

    <div style="font-size: 10px; margin-top: 5px;" class="text-warn">
      SYSTEM: 2D_BLOCK_MODE_ACTIVE
    </div>
  </header>

  <!-- Main Container -->
  <main class="main-container">
    <!-- Webcam Panel -->
    <div class="webcam-panel">
      <video id="webcam" autoplay playsinline></video>
      <canvas id="handCanvas"></canvas>
    </div>

    <!-- 3D Canvas Panel -->
    <div class="canvas-panel">
      <canvas id="canvas2d" class="canvas-layer"></canvas>
      <canvas id="threeCanvas" class="canvas-layer"></canvas>

      <!-- Color Palette -->
      <div class="color-palette" id="colorPalette">
        <div class="palette-label">Colors</div>
        <div class="palette-colors"></div>
      </div>
    </div>
  </main>

  <!-- Tutorial Modal -->
  <div id="tutorialModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Gesture Controls</h2>
        <button class="modal-close" id="closeTutorial">&times;</button>
      </div>
      <div class="modal-body">
        <div class="gesture-guide">
          <div class="gesture-item">
            <div class="gesture-icon">&#9757;</div>
            <div class="gesture-info">
              <strong>Point</strong>
              <p>Move cursor to highlight voxel position</p>
            </div>
          </div>
          <div class="gesture-item">
            <div class="gesture-icon">&#129295;</div>
            <div class="gesture-info">
              <strong>Pinch</strong>
              <p>Place a voxel at cursor position</p>
            </div>
          </div>
          <div class="gesture-item">
            <div class="gesture-icon">&#9994;</div>
            <div class="gesture-info">
              <strong>Fist</strong>
              <p>Delete voxel at cursor position</p>
            </div>
          </div>
          <div class="gesture-item">
            <div class="gesture-icon">&#9995;</div>
            <div class="gesture-info">
              <strong>Open Palm</strong>
              <p>Move hand to rotate camera</p>
            </div>
          </div>
          <div class="gesture-item">
            <div class="gesture-icon">&#9996;</div>
            <div class="gesture-info">
              <strong>Peace Sign</strong>
              <p>Cycle through colors</p>
            </div>
          </div>
          <div class="gesture-item">
            <div class="gesture-icon">&#128072;</div>
            <div class="gesture-info">
              <strong>Swipe Left</strong>
              <p>Undo last action</p>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-primary" id="startBtn">Start Creating!</button>
      </div>
    </div>
  </div>

  <!-- Export Modal -->
  <div id="exportModal" class="modal">
    <div class="modal-content modal-small">
      <div class="modal-header">
        <h2>Export Creation</h2>
        <button class="modal-close" id="closeExport">&times;</button>
      </div>
      <div class="modal-body">
        <div class="export-options">
          <button class="btn btn-export" id="exportOBJ">
            <span class="export-format">OBJ</span>
            <span class="export-desc">Standard 3D format</span>
          </button>
          <button class="btn btn-export" id="exportGLB">
            <span class="export-format">GLB</span>
            <span class="export-desc">Web-optimized format</span>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Loading Overlay -->
  <div id="loadingOverlay" class="loading-overlay">
    <div class="loading-content">
      <div class="loading-spinner"></div>
      <p>Initializing camera...</p>
    </div>
  </div>

  <!-- MediaPipe Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands@0.4.1675469240/hands.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js" crossorigin="anonymous"></script>

  <!-- Main App -->
  <script type="module" src="/src/main.js"></script>
</body>

</html>